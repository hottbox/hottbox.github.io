
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>RandomisedCPD &#8212; HOTTBOX 0.3.2 documentation</title>
    <link rel="stylesheet" href="../../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
    <script type="text/javascript" src="../../_static/js/toggle_navbar.js"></script>
    <script type="text/javascript" src="../../_static/js/toggle_header_rst_container.js"></script>
    <script type="text/javascript" src="../../_static/js/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/hottbox_favicon-48x48.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Parafac2" href="hottbox.algorithms.decomposition.Parafac2.html" />
    <link rel="prev" title="CPD" href="hottbox.algorithms.decomposition.CPD.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hottbox.algorithms.decomposition.Parafac2.html" title="Parafac2"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="hottbox.algorithms.decomposition.CPD.html" title="CPD"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">HOTTBOX 0.3.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../modules.html" >HOTTBOX API</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../hottbox.algorithms.html" accesskey="U">Algorithms</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><a href="
    ../../index.html" class="text-logo">HOTTBOX 0.3.2 documentation</a>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>
      <a href="https://github.com/hottbox/hottbox"><i class="fab fa-github fa-lg"></i> Fork me on GitHub</a>
    </h2>
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installing HOTTBOX</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">HOTTBOX API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../hottbox.core.html">Core Structures and Operations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../hottbox.algorithms.html">Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hottbox.pdtools.html">Pandas Integration Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hottbox.metrics.html">Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hottbox.rank.html">Multi-dimensional Rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hottbox.datasets.html">Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hottbox.errors.html">Custom Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hottbox.utils.html">Utility Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hottbox.contrib.html">Experimental features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">HOTTBOX Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development_guide/index.html">Development guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Our Team</a></li>
</ul>

    
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../../index.html">Docs</a></li>
              
                <li><a href="../modules.html">HOTTBOX API</a></li>
              
                <li><a href="../hottbox.algorithms.html">Algorithms</a></li>
              
              <li>RandomisedCPD</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="randomisedcpd">
<h1>RandomisedCPD<a class="headerlink" href="#randomisedcpd" title="Permalink to this headline">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import statement</span>

<span class="kn">from</span> <span class="nn">hottbox.algorithms.decomposition</span> <span class="kn">import</span> <span class="n">RandomisedCPD</span>
</pre></div>
</div>
<dl class="class">
<dt id="hottbox.algorithms.decomposition.RandomisedCPD">
<em class="property">class </em><code class="sig-name descname">RandomisedCPD</code><span class="sig-paren">(</span><em class="sig-param">init='svd'</em>, <em class="sig-param">sample_size=None</em>, <em class="sig-param">max_iter=50</em>, <em class="sig-param">epsilon=0.01</em>, <em class="sig-param">tol=0.0001</em>, <em class="sig-param">random_state=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hottbox/algorithms/decomposition/cpd.html#RandomisedCPD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hottbox.algorithms.decomposition.RandomisedCPD" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomised Canonical Polyadic Decomposition.</p>
<p>Computed via sampled alternating least squares (ALS)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>init</strong><span class="classifier">str</span></dt><dd><p>Type of factor matrix initialisation. Available options are <cite>svd</cite> and <cite>random</cite></p>
</dd>
<dt><strong>max_iter</strong><span class="classifier">int</span></dt><dd><p>Maximum number of iteration</p>
</dd>
<dt><strong>epsilon</strong><span class="classifier">float</span></dt><dd><p>Threshold for the relative error of approximation.</p>
</dd>
<dt><strong>tol</strong><span class="classifier">float</span></dt><dd><p>Threshold for convergence of factor matrices</p>
</dd>
<dt><strong>random_state</strong><span class="classifier">int</span></dt><dd></dd>
<dt><strong>verbose</strong><span class="classifier">bool</span></dt><dd><p>If True, enable verbose output</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Attributes</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 9%" />
<col style="width: 91%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>cost</strong></p></td>
<td><p>(list) A list of relative approximation errors at each iteration of the algorithm.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Battaglino, C., Ballard, G., &amp; Kolda, T. G. (2018). A Practical Randomized CP Tensor
Decomposition. SIAM Journal on Matrix Analysis and Applications, 39(2), 876–901.
<a class="reference external" href="http://doi.org/10.1137/17m1112303">http://doi.org/10.1137/17m1112303</a></p></li>
</ul>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hottbox.algorithms.decomposition.RandomisedCPD.copy" title="hottbox.algorithms.decomposition.RandomisedCPD.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>(self)</p></td>
<td><p>Copy of the CPD algorithm as a new object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hottbox.algorithms.decomposition.RandomisedCPD.decompose" title="hottbox.algorithms.decomposition.RandomisedCPD.decompose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">decompose</span></code></a>(self, tensor, rank[, keep_meta, …])</p></td>
<td><p>Performs CPD-ALS on the <code class="docutils literal notranslate"><span class="pre">tensor</span></code> with respect to the specified <code class="docutils literal notranslate"><span class="pre">rank</span></code></p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 44%" />
<col style="width: 56%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>plot</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hottbox.algorithms.decomposition.RandomisedCPD.converged">
<em class="property">property </em><code class="sig-name descname">converged</code><a class="headerlink" href="#hottbox.algorithms.decomposition.RandomisedCPD.converged" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks convergence of the Randomised CPD-ALS algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>bool</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hottbox.algorithms.decomposition.RandomisedCPD.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hottbox/algorithms/decomposition/cpd.html#RandomisedCPD.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hottbox.algorithms.decomposition.RandomisedCPD.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy of the CPD algorithm as a new object</p>
</dd></dl>

<dl class="method">
<dt id="hottbox.algorithms.decomposition.RandomisedCPD.decompose">
<code class="sig-name descname">decompose</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">tensor</em>, <em class="sig-param">rank</em>, <em class="sig-param">keep_meta=0</em>, <em class="sig-param">kr_reverse=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hottbox/algorithms/decomposition/cpd.html#RandomisedCPD.decompose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hottbox.algorithms.decomposition.RandomisedCPD.decompose" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs CPD-ALS on the <code class="docutils literal notranslate"><span class="pre">tensor</span></code> with respect to the specified <code class="docutils literal notranslate"><span class="pre">rank</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tensor</strong><span class="classifier">Tensor</span></dt><dd><p>Multi-dimensional data to be decomposed</p>
</dd>
<dt><strong>rank</strong><span class="classifier">tuple</span></dt><dd><p>Desired Kruskal rank for the given <code class="docutils literal notranslate"><span class="pre">tensor</span></code>. Should contain only one value.
If it is greater then any of dimensions then random initialisation is used</p>
</dd>
<dt><strong>keep_meta</strong><span class="classifier">int</span></dt><dd><p>Keep meta information about modes of the given <code class="docutils literal notranslate"><span class="pre">tensor</span></code>.
0 - the output will have default values for the meta data
1 - keep only mode names
2 - keep mode names and indices</p>
</dd>
<dt><strong>kr_reverse</strong><span class="classifier">bool</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>tensor_cpd</strong><span class="classifier">TensorCPD</span></dt><dd><p>CP representation of the <code class="docutils literal notranslate"><span class="pre">tensor</span></code></p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>khatri-rao product should be of matrices in reversed order. But this will duplicate original data (e.g. images)
Probably this has something to do with data ordering in Python and how it relates to kr product</p>
</dd></dl>

<dl class="method">
<dt id="hottbox.algorithms.decomposition.RandomisedCPD.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#hottbox.algorithms.decomposition.RandomisedCPD.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the decomposition</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>decomposition_name</strong><span class="classifier">str</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="clearer"></div></div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="hottbox.algorithms.decomposition.CPD.html" title="previous chapter (use the left arrow)">CPD</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="hottbox.algorithms.decomposition.Parafac2.html" title="next chapter (use the right arrow)">Parafac2</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hottbox.algorithms.decomposition.Parafac2.html" title="Parafac2"
             >next</a> |</li>
        <li class="right" >
          <a href="hottbox.algorithms.decomposition.CPD.html" title="CPD"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">HOTTBOX 0.3.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../modules.html" >HOTTBOX API</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../hottbox.algorithms.html" >Algorithms</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2017 - 2020, Ilya Kisil. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>